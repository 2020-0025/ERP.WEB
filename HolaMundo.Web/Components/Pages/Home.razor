@page "/"
@rendermode InteractiveServer
<PageTitle>Tareas</PageTitle>
<div class="form-group mb-2">
    <label for="tarea">Nombre de la tarea</label>
    <input @bind="Tarea.Nombre" type="text" class="form-control" placeholder="Nombre de la tarea" />
</div>
<div class="form-group mb-3">
    <label for="tarea">Fecha</label>
    <input @bind="Tarea.Fecha" type="date" class="form-control" placeholder="Fecha de la tarea" />
</div>

<span class="btn btn-primary" @onclick="Agregar">Agregar</span>
<div class="card mt-3">
    <div class="card-header">
        Tareas
    </div>
    <div class="card-body">
        <div class="container">
            @if (Tareas.Any())
            {
                @foreach (var t in Tareas)
                {
                    <TaskViewer Tarea="t" OnEliminar="()=>Eliminar(t.Id)" />
                }
            }
        </div>
    </div>
</div>

@code
{
    public TareaDto Tarea { get; set; } = new();
    public List<TareaDto> Tareas { get; set; } = [];
    protected override void OnInitialized()
    {

    }

    void Agregar()
    {
        Tarea.Id = Tareas.Any() ? Tareas.Max(t => t.Id) + 1 : 1;
        Tareas.Add(Tarea);
        Tarea = new();
        StateHasChanged();
    }
    void Eliminar(int Id)
    {
        var tarea = Tareas.FirstOrDefault(t => t.Id == Id);
        if (tarea != null)
        {
            Tareas.Remove(tarea);
            StateHasChanged();
        }
    }
}